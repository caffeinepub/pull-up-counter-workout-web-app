{
  "kind": "spec_vs_diff_report",
  "version": "1.0",
  "generatedAt": "2026-02-15T20:01:04.112Z",
  "summary": "Frontend changes add explicit loading/fetched gating around authenticated React Query data (today total/stats/goal) to avoid transient 0/null “reset” renders on refresh, and introduce/consume local-only hooks for guest persistence. Backend changes shown define in-memory Maps for profiles/stats/goals, but the diff does not show stable storage or upgrade hooks needed to persist authenticated data across canister upgrades.",
  "missing_requirements": [
    {
      "id": "REQ-41",
      "requirement": "Persist authenticated user data in the Motoko canister across upgrades by storing and restoring all required state in stable variables via upgrade hooks (at minimum: user profiles, per-user per-day stats/totals, per-user daily goals).",
      "reason": "The backend diff excerpt shows state held in non-stable in-memory Maps (userProfiles, dailyStats, userDailyGoals) and does not show any stable variables nor preupgrade/postupgrade (or equivalent) logic to serialize/restore this state across upgrades. Without that, authenticated data can be lost on redeploy/upgrade.",
      "evidence": [
        "backend/main.mo"
      ]
    }
  ],
  "hallucinated_features": [
    {
      "description": "Added backend admin/third-party access query endpoints for reading another user’s day totals/stats (getDayTotalForUser, getDayStatsForUser).",
      "reason": "These APIs are not requested by REQ-39/40/41 (which focus on persistence/rehydration and upgrade-stable storage). They appear to be additional capabilities beyond the scope.",
      "evidence": [
        "backend/main.mo"
      ]
    }
  ],
  "confidence": 0.62,
  "changed_files": [
    "backend/main.mo",
    "frontend-file-summaries.txt",
    "frontend/src/features/counter/CounterScreen.tsx",
    "frontend/src/features/stats/StatsView.tsx",
    "frontend/src/hooks/useQueries.ts",
    "project_state.json"
  ]
}